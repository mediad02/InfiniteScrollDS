// ==UserScript==
// @name         ArbicareAccession
// @namespace    http://tampermonkey.net/
// @version      0.03
// @description  Accession data from Arbicare.
// @author       Adolfo Medina
// @match        https://mail.google.com/mail/u/*/*
// @icon         https://www.google.com/s2/favicons?sz=64&domain=arbicare.com
// @updateURL    https://raw.githubusercontent.com/mediad02/InfiniteScrollDS/main/ArbicareAccession.user.js
// @downloadURL  https://raw.githubusercontent.com/mediad02/InfiniteScrollDS/main/ArbicareAccession.user.js
// ==/UserScript==
"use strict";(()=>{function S(){let e=document.createElement("button");return e.textContent="Copy Referral",e.style.position="fixed",e.style.bottom="50px",e.style.left="24px",e.style.zIndex="10000",e.style.padding="12px 24px",e.style.background="#1976d2",e.style.color="#fff",e.style.border="none",e.style.borderRadius="6px",e.style.boxShadow="0 2px 8px rgba(0,0,0,0.15)",e.style.fontSize="16px",e.style.fontWeight="bold",e.style.cursor="pointer",e.style.transition="background 0.2s",e}function g(e,t){e.disabled=!t,e.style.opacity=t?"1":"0.5",e.style.cursor=t?"pointer":"not-allowed",e.dataset.copied||(e.style.background=t?"#1976d2":"#bdbdbd")}function C(e,t=2e3){let n=e.textContent,r=e.style.background;e.textContent="Referral Copied",e.style.background="#43a047",e.dataset.copied="true",setTimeout(()=>{e.textContent=n,e.style.background=e.disabled?"#bdbdbd":"#1976d2",delete e.dataset.copied},t)}function A(e,t=2e3){let n=e.textContent,r=e.style.background;e.textContent="Copy Error",e.style.background="#d32f2f",e.dataset.copied="true",setTimeout(()=>{e.textContent=n,e.style.background=e.disabled?"#bdbdbd":"#1976d2",delete e.dataset.copied},t)}function x(){let e=document.querySelector("h2.hP, h1.hP");return e&&e.textContent?.trim()||null}function w(e){let t=document.body;new MutationObserver(()=>e()).observe(t,{childList:!0,subtree:!0})}var i=S();g(i,!1);document.body.appendChild(i);i.addEventListener("click",async()=>{let e=document.querySelector("div.a3s"),t=x(),n=document.querySelector("span.g3, span.gH, span.gK"),r=n&&(n.getAttribute("title")||n.textContent?.trim())||"";if(e&&t&&r){let o=e.textContent||"",d=L(t,o,r);try{await navigator.clipboard.writeText(d),C(i)}catch{try{let c=document.createRange();c.selectNodeContents(e);let l=window.getSelection();l?.removeAllRanges(),l?.addRange(c);let u=document.execCommand("copy");l?.removeAllRanges(),u?C(i):A(i)}catch{A(i)}}}});document.addEventListener("keydown",e=>{e.ctrlKey&&(e.key==="c"||e.key==="C")&&!i.disabled&&!window.getSelection()?.toString()&&(e.preventDefault(),i.click())});function L(e,t,n){let r="",o="",d="",a=new Date(n);isNaN(a.getTime())||(a.setHours(a.getHours()),r=a.toLocaleDateString("default",{month:"2-digit",day:"2-digit",year:"numeric"}),o=a.toLocaleTimeString("en-default",{hour:"numeric",minute:"2-digit"}));let c=e.match(/Arbicare Referral for Setup\s*-\s*([A-Z0-9.\-]+)\s*-/i),l=c?c[1]:"",u=t.match(/Case Number\s*-\s*0*([0-9]+)/i),T=u?u[1]:"",y=t.match(/Client Name\s*-\s*([^\n\r]+)/i),R=y?y[1].trim():"",v=p(R,D),M=t.match(/Priority\s*-\s*(\w+)/i),h=M&&M[1].toLowerCase()==="stat"?"X":"",f=t.match(/Review- [^,]+, ([^\n\r]+)/i),m=f?f[1].trim():"";m=p(m,H);let b=t.match(/Jurisdiction\s*-\s*([A-Za-z ]+)/i),I=b?b[1].trim():"",k=p(I,E);if(o){let s=new Date(n);s.setHours(s.getHours()),h==="X"?s.setHours(s.getHours()+1):s.setHours(s.getHours()+3),d=s.toLocaleTimeString("en-default",{hour:"numeric",minute:"2-digit"})}return[r,h,l,T,v,m,"",k,o,d].join("	")}var E={Alabama:"AL",Alaska:"AK",Arizona:"AZ",Arkansas:"AR",California:"CA",Colorado:"CO",Connecticut:"CT",Delaware:"DE",Florida:"FL",Georgia:"GA",Hawaii:"HI",Idaho:"ID",Illinois:"IL",Indiana:"IN",Iowa:"IA",Kansas:"KS",Kentucky:"KY",Louisiana:"LA",Maine:"ME",Maryland:"MD",Massachusetts:"MA",Michigan:"MI",Minnesota:"MN",Mississippi:"MS",Missouri:"MO",Montana:"MT",Nebraska:"NE",Nevada:"NV","New Hampshire":"NH","New Jersey":"NJ","New Mexico":"NM","New York":"NY","North Carolina":"NC","North Dakota":"ND",Ohio:"OH",Oklahoma:"OK",Oregon:"OR",Pennsylvania:"PA","Rhode Island":"RI","South Carolina":"SC","South Dakota":"SD",Tennessee:"TN",Texas:"TX",Utah:"UT",Vermont:"VT",Virginia:"VA",Washington:"WA","West Virginia":"WV",Wisconsin:"WI",Wyoming:"WY"},H={"New York Drug Formulary":"NYDF"},D={"Cincinnati Insurance":"Cincinnati","AmTrust Financial Services Group":"AmTrust","Pacific Claims":"PCM","All America Insurance":" All America Insu.","Accident Fund Co":"Accident Fund","North American Risk Services Inc":"NARS","Employers Insurance":"Empl Insu.","Marriott International":"Marriott",Travelers:"Travelers","Hammerman & Gainer LLC":"HGI","Wright Risk Management":"Wright Risk","Central Mutual Insurance Co":"Cent Mutual Ins.","Status Medical Management":"Status Med","Constitution State Services":"CSS","Preferred Medical":"Preferred Med",TPCIGA:"TPCIGA","Innovative Claims Strategies":"Inn Claim Strat.",ArcBest:"ArcBest","American Equity Underwriters":"Ame Equ Unde.",ForceRx:"ForceRx","Waypoint Mutual":"Waypoint Mutual","Assigned Risk Solutions":"Assigned Risk Sol.","INVO Claims Administrators":"INVO Claims Admin.","AmeriTrust Group":"AmeriTrust Group","PMA Companies Inc":"PMA Companies Inc","Claims Management Consultants":"CMC","American Risk Administrators, LLC":"ARA, LLC",MyMatrixx:"MyMatrixx","Veritas Administrators, LLC":"Veritas Admin. LLC","AAC Risk Management Services":"AAC Risk Mgmt Svcs"};function p(e,t){return t[e]||e}function N(){let e=x(),t=!!e&&e.startsWith("Arbicare Referral for Setup");g(i,t)}w(N);N();})();
